VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
END
Attribute VB_Name = "clsDao"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Option Explicit

'************************************************************************************
' ?øΩ@?øΩ@?øΩ\    :DB?øΩ⁄ëÔøΩ?øΩ?øΩ?øΩ
' Ver       :1.0.00
' -----------------------------------------------------------------------------------
' ?øΩ?øΩ?øΩ@?øΩ?øΩ?øΩ@?øΩpecorimaru2/11/01  pecorimaru  Ver.1.0.00  ?øΩV?øΩK?øΩ?ê¨
'************************************************************************************

'?øΩR?øΩl?øΩN?øΩV?øΩ?øΩ?øΩ?øΩ
Private pCon As ADODB.Connection

'************************************************************************************
' ?øΩ@?øΩ@?øΩ\    :?øΩR?øΩ?øΩ?øΩX?øΩg?øΩ?øΩ?øΩN?øΩ^
' -----------------------------------------------------------------------------------
' ?øΩ?øΩ?øΩ@?øΩ?øΩ?øΩ@?øΩpecorimaru2/11/01  pecorimaru  Ver.1.0.00  ?øΩV?øΩK?øΩ?ê¨
'************************************************************************************
Private Sub Class_Initialize()

    Set pCon = New ADODB.Connection

End Sub
'************************************************************************************
' ?øΩ@?øΩ@?øΩ\    :?øΩf?øΩX?øΩg?øΩ?øΩ?øΩN?øΩ^
' -----------------------------------------------------------------------------------
' ?øΩ?øΩ?øΩ@?øΩ?øΩ?øΩ@?øΩpecorimaru2/11/01  pecorimaru  Ver.1.0.00  ?øΩV?øΩK?øΩ?ê¨
'************************************************************************************
Private Sub Class_Terminate()

    Set pCon = Nothing

End Sub
'************************************************************************************
' ?øΩ@?øΩ@?øΩ\    :?øΩZ?øΩb?øΩ^?øΩ[_?øΩR?øΩl?øΩN?øΩV?øΩ?øΩ?øΩ?øΩ
' -----------------------------------------------------------------------------------
' ?øΩ?øΩ?øΩ@?øΩ?øΩ?øΩ@?øΩpecorimaru2/11/01  pecorimaru  Ver.1.0.00  ?øΩV?øΩK?øΩ?ê¨
'************************************************************************************
Public Property Set con(ByRef bean As ADODB.Connection)
    Set pCon = bean
End Property

'************************************************************************************
' ?øΩ@?øΩ@?øΩ\    :?øΩQ?øΩb?øΩ^?øΩ[_?øΩR?øΩl?øΩN?øΩV?øΩ?øΩ?øΩ?øΩ
' -----------------------------------------------------------------------------------
' ?øΩ?øΩ?øΩ@?øΩ?øΩ?øΩ@?øΩpecorimaru2/11/01  pecorimaru  Ver.1.0.00  ?øΩV?øΩK?øΩ?ê¨
'************************************************************************************
Public Property Get con() As ADODB.Connection
    Set con = pCon
End Property

'************************************************************************************
' ?øΩ@?øΩ@?øΩ\    :DB?øΩR?øΩl?øΩN?øΩV?øΩ?øΩ?øΩ?øΩ?øΩ?øΩ?øΩÊìæ
' ?øΩ?øΩ?øΩ@?øΩ?øΩ    :in  baseStmt                        ?øΩR?øΩl?øΩN?øΩV?øΩ?øΩ?øΩ?øΩ?øΩX?øΩe?øΩ[?øΩg?øΩ?øΩ?øΩ?øΩ?øΩg
'           :in  envBean                         ?øΩ¬ãÔøΩ?øΩ?øΩ?øΩBean
' ?øΩﬂÅ@?øΩl    :DB?øΩR?øΩl?øΩN?øΩV?øΩ?øΩ?øΩ?øΩ
' -----------------------------------------------------------------------------------
' ?øΩ?øΩ?øΩ@?øΩ?øΩ?øΩ@?øΩpecorimaru2/11/01  pecorimaru  Ver.1.0.00  ?øΩV?øΩK?øΩ?ê¨
'************************************************************************************
Public Sub conOpen(ByVal baseStmt As String, ByRef envBean As clsEnvBean)
    
    '"Driver={PostgreSQL Unicode};Server={1};Database={2};UID={3};PWD={4};Port={5};INITIAL CATALOG={6};"
    With envBean
        Dim stmt As String
        stmt = ReplacePh(baseStmt, .svr, .db, .ue, .ps, .pt, .sc)
    End With

    con.Open (stmt)

End Sub


'************************************************************************************
' ?øΩ@?øΩ@?øΩ\    :DB?øΩN?øΩ?øΩ?øΩ[?øΩY(?øΩ?øΩ?øΩ?øΩ?øΩ≈îÔøΩ?øΩ?øΩ?øΩ?øΩ?øΩ?øΩG?øΩ?øΩ?øΩ[?øΩÕñÔøΩ?øΩ?øΩ)
' ?øΩ?øΩ?øΩ@?øΩ?øΩ    :in  rs                              ?øΩ?øΩ?øΩR?øΩ[?øΩh?øΩZ?øΩb?øΩg
' ?øΩﬂÅ@?øΩl    :?øΩ»ÇÔøΩ
' -----------------------------------------------------------------------------------
' ?øΩ?øΩ?øΩ@?øΩ?øΩ?øΩ@?øΩpecorimaru2/10/18  pecorimaru  Ver.1.0.00  ?øΩV?øΩK?øΩ?ê¨
'************************************************************************************
Public Sub conClose(Optional ByRef rs As ADODB.Recordset = Nothing)

    On Error Resume Next

    If pCon.State = adStateOpen Then
        pCon.Close
    End If
    
    If rs.State = adStateOpen Then
        rs.Close
    End If

    On Error GoTo 0

End Sub

